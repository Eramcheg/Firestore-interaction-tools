import openpyxl
import csv
import io
import firebase_admin
from firebase_admin import credentials, firestore
import ftplib
import datetime
# Initialize Firebase Admin with your service account credentials
cred = credentials.Certificate("G:\\FIles\\firebase\\key2.json")
firebase_admin.initialize_app(cred)
db = firestore.client()

# Reference the collection where you want to update the document
collection_ref = firestore.client().collection("item")

# Load Excel workbook
xlsx_file_path = "C:/Users/eramc/Downloads/Telegram Desktop/Winter_Collection_2024.xlsx"
workbook = openpyxl.load_workbook(xlsx_file_path)
sheet = workbook.active
images = {'12450': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12450.jpg', '12451': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12451.jpg', '12451G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12451G.jpg', '12452': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12452.jpg', '12453': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12453.jpg', '12454': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12454.jpg', '12455': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12455.jpg', '12456': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12456.jpg', '12456G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12456G.jpg', '12457': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12457.jpg', '12457G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12457G.jpg', '12458 PIN': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12458%20PIN.jpg', '12459': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12459.jpg', '12460': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12460.jpg', '12460G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12460G.jpg', '12461G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12461G.jpg', '12462': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12462.jpg', '12463': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12463.jpg', '12464': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12464.jpg', '12465 GRE': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12465%20GRE.jpg', '12465 VIO': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12465%20VIO.jpg', '12466': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12466.jpg', '12467 BLU': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12467%20BLU.jpg', '12467 PIN': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12467%20PIN.jpg', '12468G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12468G.jpg', '12469G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12469G.jpg', '12470G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12470G.jpg', '12471G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12471G.jpg', '12472G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12472G.jpg', '12473 SAP': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12473%20SAP.jpg', '12473 WHI': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12473%20WHI.jpg', '12473G LTOP': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12473G%20LTOP.jpg', '12473G WHI': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12473G%20WHI.jpg', '12474 WHI': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12474%20WHI.jpg', '12474G WHI': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12474G%20WHI.jpg', '12475 EME': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12475%20EME.jpg', '12475 LSAP': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12475%20LSAP.jpg', '12476G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12476G.jpg', '12477G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12477G.jpg', '12478': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12478.jpg', '12478G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12478G.jpg', '12479': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12479.jpg', '12480': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/12480.jpg', '23175': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23175.jpg', '23176': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23176.jpg', '23177': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23177.jpg', '23178': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23178.jpg', '23179': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23179.jpg', '23180': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23180.jpg', '23180G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23180G.jpg', '23181': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23181.jpg', '23181G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23181G.jpg', '23182': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23182.jpg', '23183': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23183.jpg', '23184': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23184.jpg', '23185 PIN': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23185%20PIN.jpg', '23185 WHI': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23185%20WHI.jpg', '23186': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23186.jpg', '23187': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23187.jpg', '23187G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23187G.jpg', '23188': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23188.jpg', '23189': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23189.jpg', '23190': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23190.jpg', '23191 GRE': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23191%20GRE.jpg', '23191 VIO': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23191%20VIO.jpg', '23192': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23192.jpg', '23193 BLU': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23193%20BLU.jpg', '23193 PIN': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23193%20PIN.jpg', '23194G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23194G.jpg', '23195G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23195G.jpg', '23196G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23196G.jpg', '23197G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23197G.jpg', '23198G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23198G.jpg', '23199G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23199G.jpg', '23200G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23200G.jpg', '23201G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23201G.jpg', '23202': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23202.jpg', '23203': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/23203.jpg', '32423 PIN': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/32423%20PIN.jpg', '32423 WHI': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/32423%20WHI.jpg', '32424 BLU': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/32424%20BLU.jpg', '32424 PIN': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/32424%20PIN.jpg', '32425G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/32425G.jpg', '32426': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/32426.jpg', '32426G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/32426G.jpg', '32426RG': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/32426RG.jpg', '32427': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/32427.jpg', '32427G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/32427G.jpg', '32428': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/32428.jpg', '32428G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/32428G.jpg', '32429': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/32429.jpg', '32429G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/32429G.jpg', '32430G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/32430G.jpg', '32431': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/32431.jpg', '32432G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/32432G.jpg', '32433G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/32433G.jpg', '41223': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/41223.jpg', '41224LXL': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/41224LXL.jpg', '41224SM': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/41224SM.jpg', '41225LXL': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/41225LXL.jpg', '41225SM': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/41225SM.jpg', '41226GL': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/41226GL.jpg', '41226GM': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/41226GM.jpg', '41226GS': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/41226GS.jpg', '41226GXL': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/41226GXL.jpg', '41227LXL': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/41227LXL.jpg', '41227SM': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/41227SM.jpg', '41228LXL': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/41228LXL.jpg', '41228SM': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/41228SM.jpg', '58052 GRE': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/58052%20GRE.jpg', '58053 PIN': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/58053%20PIN.jpg', '58054 GRE': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/58054%20GRE.jpg', '58054 PIN': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/58054%20PIN.jpg', '58055 GRE': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/58055%20GRE.jpg', '58055 PIN': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/58055%20PIN.jpg', '58056 GRE': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/58056%20GRE.jpg', '58057G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/58057G.jpg', '58058': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/58058.jpg', '58059G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/58059G.jpg', '58060G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/58060G.jpg', '58061': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/58061.jpg', '58062G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/58062G.jpg', '58063G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/58063G.jpg', '58064G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/58064G.jpg', '58065G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/58065G.jpg', '58066': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/58066.jpg', '58067': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/58067.jpg', '58068': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/58068.jpg', '58069G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/58069G.jpg', '61292': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61292.jpg', '61293': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61293.jpg', '61294': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61294.jpg', '61295': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61295.jpg', '61296': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61296.jpg', '61297': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61297.jpg', '61298': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61298.jpg', '61299': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61299.jpg', '61300': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61300.jpg', '61301': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61301.jpg', '61302': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61302.jpg', '61303': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61303.jpg', '61304': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61304.jpg', '61305G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61305G.jpg', '61306': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61306.jpg', '61307': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61307.jpg', '61308': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61308.jpg', '61309': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61309.jpg', '61310': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61310.jpg', '61311': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61311.jpg', '61312': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61312.jpg', '61312G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61312G.jpg', '61313G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61313G.jpg', '61314': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61314.jpg', '61315': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61315.jpg', '61316G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61316G.jpg', '61317': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61317.jpg', '61318': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61318.jpg', '61319': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/61319.jpg', '62242 WHI': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62242%20WHI.jpg', '62260': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62260.jpg', '62261': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62261.jpg', '62262': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62262.jpg', '62263': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62263.jpg', '62264': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62264.jpg', '62265': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62265.jpg', '62266': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62266.jpg', '62267': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62267.jpg', '62268': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62268.jpg', '62269': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62269.jpg', '62270': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62270.jpg', '62271': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62271.jpg', '62272': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62272.jpg', '62273': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62273.jpg', '62274': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62274.jpg', '62275': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62275.jpg', '62276': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62276.jpg', '62277G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62277G.jpg', '62278': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62278.jpg', '62279': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62279.jpg', '62280': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62280.jpg', '62281': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62281.jpg', '62282': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62282.jpg', '62282G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62282G.jpg', '62283': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62283.jpg', '62284': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62284.jpg', '62285G': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62285G.jpg', '62286': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62286.jpg', '62287': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62287.jpg', '62288': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/62288.jpg', '63346L': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63346L.jpg', '63346M': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63346M.jpg', '63346S': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63346S.jpg', '63346XL': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63346XL.jpg', '63347L': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63347L.jpg', '63347M': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63347M.jpg', '63347S': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63347S.jpg', '63347XL': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63347XL.jpg', '63348L': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63348L.jpg', '63348M': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63348M.jpg', '63348S': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63348S.jpg', '63348XL': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63348XL.jpg', '63349L': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63349L.jpg', '63349M': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63349M.jpg', '63349S': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63349S.jpg', '63349XL': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63349XL.jpg', '63350': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63350.jpg', '63351L': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63351L.jpg', '63351M': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63351M.jpg', '63351S': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63351S.jpg', '63351XL': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63351XL.jpg', '63352L': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63352L.jpg', '63352M': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63352M.jpg', '63352S': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63352S.jpg', '63352XL': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63352XL.jpg', '63353L GRE': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63353L%20GRE.jpg', '63353L PIN': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63353L%20PIN.jpg', '63353M GRE': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63353M%20GRE.jpg', '63353M PIN': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63353M%20PIN.jpg', '63353S GRE': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63353S%20GRE.jpg', '63353S PIN': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63353S%20PIN.jpg', '63353XL GRE': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63353XL%20GRE.jpg', '63353XL PIN': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63353XL%20PIN.jpg', '63354L GRE': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63354L%20GRE.jpg', '63354L PIN': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63354L%20PIN.jpg', '63354M GRE': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63354M%20GRE.jpg', '63354M PIN': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63354M%20PIN.jpg', '63354S GRE': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63354S%20GRE.jpg', '63354S PIN': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63354S%20PIN.jpg', '63354XL GRE': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63354XL%20GRE.jpg', '63354XL PIN': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63354XL%20PIN.jpg', '63355L': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63355L.jpg', '63355M': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63355M.jpg', '63355S': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63355S.jpg', '63355XL': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63355XL.jpg', '63356L': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63356L.jpg', '63356M': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63356M.jpg', '63356S': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63356S.jpg', '63356XL': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63356XL.jpg', '63357L': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63357L.jpg', '63357M': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63357M.jpg', '63357S': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63357S.jpg', '63357XL': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63357XL.jpg', '63358L': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63358L.jpg', '63358M': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63358M.jpg', '63358S': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63358S.jpg', '63358XL': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63358XL.jpg', '63359L': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63359L.jpg', '63359M': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63359M.jpg', '63359S': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63359S.jpg', '63359XL': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63359XL.jpg', '63360L': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63360L.jpg', '63360M': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63360M.jpg', '63360S': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63360S.jpg', '63360XL': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63360XL.jpg', '63361L': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63361L.jpg', '63361M': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63361M.jpg', '63361S': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63361S.jpg', '63361XL': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63361XL.jpg', '63362L': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63362L.jpg', '63362M': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63362M.jpg', '63362S': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63362S.jpg', '63362XL': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63362XL.jpg', '63549': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63549.jpg', '63550': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63550.jpg', '63551': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63551.jpg', '63552': 'https://storage.googleapis.com/flutterapp-fd5c3.appspot.com/NewImages/63552.jpg'}

updates = []
names_from_excel = set()
for row in sheet.iter_rows(min_row=3, values_only=True):
    name, plating, size, category, stone, product_name, material, description = row[0], row[7], row[10], row[2], 'Default', row[6], row[12], row[11]
    price, priceGH, priceUSD, priceUSD_GH, priceVK3, priceVK4 = round(row[32], 2), round(row[31], 2), round(row[34], 2), round(row[33], 2), round(row[32], 2), round(row[36], 2)

    if not size:
        updates.append({
            'Visible': True,
            'category': category,
            'description': description,
            'image-url': images[name] if name in images else 'https://firebasestorage.googleapis.com/v0/b/flutterapp-fd5c3.appspot.com/o/wall%2Fno_image.jpg?alt=media&token=22a7b907-01f6-45b6-8fb1-f1f884ab21d4',
            'image_url': images[name] if name in images else 'https://firebasestorage.googleapis.com/v0/b/flutterapp-fd5c3.appspot.com/o/wall%2Fno_image.jpg?alt=media&token=22a7b907-01f6-45b6-8fb1-f1f884ab21d4',
            'material': material if material else 'Brass',
            'name': name,
            'plating': plating if plating else 'Rhodium',
            'price': price,
            'priceGH': priceGH,
            'priceUSD': priceUSD,
            'priceUSD_GH': priceUSD_GH,
            'priceVK3': priceVK3,
            'priceVK4': priceVK4,
            # 'size': size if size else "Default",
            'product_name': product_name,
            'quantity': 0,
            'stone': stone
        })
    else:
        updates.append({
            'Visible': True,
            'category': category,
            'description': description,
            'image-url': images[name] if name in images else 'https://firebasestorage.googleapis.com/v0/b/flutterapp-fd5c3.appspot.com/o/wall%2Fno_image.jpg?alt=media&token=22a7b907-01f6-45b6-8fb1-f1f884ab21d4',
            'image_url': images[name] if name in images else 'https://firebasestorage.googleapis.com/v0/b/flutterapp-fd5c3.appspot.com/o/wall%2Fno_image.jpg?alt=media&token=22a7b907-01f6-45b6-8fb1-f1f884ab21d4',
            'material': material if material else 'Brass',
            'name': name,
            'plating': plating if plating else 'Rhodium',
            'price': price,
            'priceGH': priceGH,
            'priceUSD': priceUSD,
            'priceUSD_GH': priceUSD_GH,
            'priceVK3': priceVK3,
            'priceVK4': priceVK4,
            'size': size if size else "Default",
            'product_name': product_name,
            'quantity': 0,
            'stone': stone,
        })
    names_from_excel.add(name)

print(updates)
for update in updates:
    # Reference the 'item' collection, and Firestore will generate a unique document ID
    doc_ref = collection_ref.document()  # Auto-generate document ID

    # Upload the data
    try:
        doc_ref.set(update)
        print(f"Document with auto-generated ID successfully uploaded.")
    except Exception as e:
        print(f"Error uploading document: {e}")
# batch = db.batch()
# collection_ref = db.collection('item')
#
#
# for data in updates:
#     doc_ref = collection_ref.where('name', '==', data['name']).get()
#     if doc_ref:
#
#         for doc in doc_ref:
#             # if(data["size"] != "Default"):
#                 batch.update(doc.reference, {
#                     'plating': data['plating'],
#                     # 'size': data['size'],
#                     'stone': data['stone'],
#                     'material': data['material'],
#                     # 'product_name': data['product_name']
#                 })
#     else:
#         print(f"Document with name {data['name']} not found")
#
# batch.commit()

# all_docs = collection_ref.stream()
# unmodified_names = [doc.to_dict()['name'] for doc in all_docs if doc.to_dict()['name'] not in names_from_excel]
#
# # Generate CSV
# with open('unmodified_names.csv', 'w', newline='', encoding='utf-8') as file:
#     writer = csv.writer(file)
#     writer.writerow(['name'])
#     for name in unmodified_names:
#         writer.writerow([name])
#
# print("CSV of unmodified documents created.")
